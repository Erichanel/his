# configs/tokenizer_hsivq_ssse.yaml
data:
  patch_size: 9       # patch 大小 (H=W=9)
  cube_size: 3        # non-overlap cube 大小 (s=3)
  pretrain_stride: 3  # 预训练 patch 采样步长（1 表示滑窗）
  pca_group: 8        # GWPCA 分组数
  pca_nc_per_group: 8 # 每组 PCA 维度
  pca_max_samples: 50000 # PCA 拟合采样上限（None 表示全量）
  use_zscore: true    # 是否启用 z-score 归一化
  zscore_max_samples: 50000 # z-score 统计采样上限（None 表示全量）
  C_in: 64            # PCA 输出通道数 (T*L)
  T: 8                # 光谱分组数
  L: 8                # 每组波段数
  dataset_name: WHU_Hi_LongKou # 数据集名称
  data_path: WHU_Hi_LongKou.mat # 光谱数据路径
  gt_path: WHU_Hi_LongKou_gt.mat # 标签路径（可为空）
  data_key: WHU_Hi_LongKou # 数据矩阵 key（可选）
  gt_key: WHU_Hi_LongKou_gt # 标签矩阵 key（可选）

vq:
  Ks: 256         # 光谱码本大小
  Kx: 256        # 空间码本大小
  D_vq: 256      # VQ 嵌入维度
  vq_decay: 0.99 # EMA 衰减
  vq_beta: 0.5  # commitment 权重

train:
  batch_size: 8  # batch 大小
  epochs: 50     # 训练轮数
  lr: 0.0005     # 学习率
  wd: 0.01       # 权重衰减
  lambda_recon_s: 1.0 # spectral recon weight
  lambda_recon_x: 1.0 # spatial recon weight
  seed: 42       # 随机种子
  steps_per_epoch: null # 每轮最大步数（null 表示全量）
  log_interval: null # 训练日志打印间隔（步，null 关闭）
  usage_interval: 200 # 码本利用率统计间隔（步）
  num_workers: 4 # DataLoader 进程数
  pin_memory: true # 是否锁页内存
  persistent_workers: true # 是否保持 worker 常驻
  prefetch_factor: 2 # 每个 worker 预取 batch 数
  save_path: tokenizer_ckpt.pt # 保存 tokenizer 权重路径
  debug_update: false # print grad/param delta for sanity check
  debug_interval: 200 # steps between debug prints
